<h3 class="form-header">{{ localize "DND4E.ItemConsumableDetails" }}</h3>
  {{!-- Consumable Type --}}
  <div class="form-group">
    <label>{{ localize "DND4E.ItemConsumableType" }}</label>
    <select name="system.consumableType">
      {{selectOptions config.consumableTypes selected=system.consumableType labelAttr="label"}}
    </select>
  </div>

  <div class="form-group stacked">
    <label>{{ localize "DND4E.ItemConsumableStatus" }}</label>
    <label class="checkbox">
      <input type="checkbox" name="system.equipped" {{checked system.equipped}}/> {{ localize "DND4E.Equipped" }}
    </label>
    <label class="checkbox">
      <input type="checkbox" name="system.identified" {{checked system.identified}}/> {{ localize "DND4E.Identified" }}
    </label>
    <label class="checkbox">
      <input type="checkbox" name="system.attuned" {{checked system.attuned}}/> {{ localize "DND4E.Attuned" }}
    </label>
  </div>

  <h3 class="form-header">{{ localize "DND4E.ItemConsumableUsage" }}</h3>

  <div class="form-group">
    <label class="checkbox">
      <input type="checkbox" name="system.uses.autoDestroy" {{checked system.uses.autoDestroy}}/> {{ localize "DND4E.ItemDestroyEmpty" }}
    </label>
  </div>

  {{!-- Limited Uses --}}
  <div class="form-group uses-per">
    <label>{{ localize "DND4E.LimitedUses" }}</label>
    <div class="form-fields">
      <input type="text" name="system.uses.value" value="{{system.uses.value}}" data-dtype="Number"/>
      <span class="sep"> {{ localize "DND4E.of" }} </span>
      <input type="text" name="system.uses.max" value="{{system.uses.max}}"/>
      <select name="system.uses.per">
        {{selectOptions config.limitedUsePeriods selected=system.uses.per labelAttr="label"}}
      </select>
    </div>
  </div>
  
  {{!-- Consumption --}}
  <div class="form-group uses-per">
    <label>{{ localize "DND4E.ConsumeTitle" }}</label>
    <div class="form-fields consumption">
      <select class="consume-type" name="system.consume.type">
        {{selectOptions config.abilityConsumptionTypes selected=system.consume.type labelAttr="label"}}
      </select>
      {{#if system.consume.type}}
        <select name="system.consume.target">
          {{selectOptions abilityConsumptionTargets selected=system.consume.target}}
        </select>
        <input type="text" name="system.consume.amount" value="{{system.consume.amount}}" data-dtype="Number"/>
      {{/if}}
    </div>
  </div>


  {{#if system.activation.type}}
  <div class="form-group">
    <label class="checkbox">
      <input type="checkbox" name="system.uses.autoDestroy" {{checked system.uses.autoDestroy}}/> {{ localize "DND4E.ItemDestroyEmpty" }}
    </label>
  </div>
  {{/if}}

  <h3 class="form-header">{{ localize "DND4E.ItemConsumableActivation" }}</h3>

  <div class="form-group">
    <label class="auto-card">{{ localize "DND4E.PowerAutoGeneratePowerCardLable" }}</label>
    <span class="checkbox"><input type="checkbox" name="system.autoGenChatPowerCard" data-dtype="Boolean" {{checked system.autoGenChatPowerCard}}/></span>
  </div>

  {{!-- Action Type --}}
  <div class="form-group select">
    <label>{{ localize "DND4E.ItemActionType" }}</label>
    <select name="system.actionType">
      {{selectOptions config.abilityActivationTypes selected=system.actionType labelAttr="label"}}
    </select>
  </div>

  {{!-- Attack Details--}}
  <div class="form-group">
    <label>{{ localize "DND4E.IsAttack" }}</label>
    <span class="checkbox"><input type="checkbox" name="system.attack.isAttack" data-dtype="Boolean" {{checked system.attack.isAttack}}/></span>
  </div>

  {{#if system.attack.isAttack}}
  <div class="form-group uses-per">
    <label>{{ localize "DND4E.Range" }}</label>
    <div class="form-fields item-range">
      <select name="system.rangeType">
        {{selectOptions config.rangeTypeNoWeapon selected=system.rangeType labelAttr="label"}}
      </select>
      {{#if system.isArea}}
      <span>{{ localize "DND4E.AreaOf" }}</span>
      <input type="text" name="system.area" value="{{system.area}}"/>
      {{/if}}					
      
      {{#if system.isRange}}
      {{#if system.isArea}}<span class="range-within-of">{{ localize "DND4E.RangeWithinOf" }}</span>{{/if}}
      
      {{#unless system.isArea}}<div class="form-fields">{{/unless}}
      
      <input type="text" name="system.rangePower" data-tooltip="{{ localize 'DND4E.WeaponRangeShort' }}: {{ localize 'DND4E.WeaponRangeShortTip' }}" value="{{system.rangePower}}" data-dtype="Number"/>
      
      {{#unless system.isArea}}
        <input class="hidden" type="text" name="system.range.value" value="{{#if system.range.long}}{{system.rangePower}}{{/if}}" data-dtype="Number" />
        {{#if (eq system.rangeType 'range')}}
          <span class="sep">/</span>
          <input type="text" name="system.range.long" value="{{system.range.long}}" data-tooltip="{{ localize 'DND4E.WeaponRangeLong' }}: {{ localize 'DND4E.WeaponRangeLongTip' }}" placeholder="{{ localize 'DND4E.WeaponRangeLong' }}" data-dtype="Number" onClick="this.select();"/>
        {{/if}}
      {{/unless}}
      
      {{#unless system.isArea}}</div>{{/unless}}					
      {{/if}}
      
    </div>
  </div>

  {{#if system.isArea}}
  <div class="form-group short">
    <label>{{ localize "DND4E.AutoTarget" }}</label>
    <div class="form-fields auto-target">
      <select name="system.autoTarget.mode">
        {{selectOptions config.autoTargetModes selected=system.autoTarget.mode}}
      </select>
      {{#unless system.excludeUserFromTargeting}}
        <label>{{ localize "DND4E.AutoTargetIncludeSelf" }}</label>
        <span class="checkbox"><input class="checkbox" type="checkbox" name="system.autoTarget.includeSelf" data-dtype="Boolean" {{checked system.autoTarget.includeSelf}}/></span>
      {{/unless}}
    </div>
  </div>
  {{/if}}
  {{!-- Attack--}}
  <div class="form-group uses-per">
    <label>{{ localize "DND4E.Attack" }}</label>
    <div class="form-fields">
      <span>{{ localize "DND4E.VS" }}</span>
      <select name="system.attack.def">
        {{selectOptions config.defensives selected=system.attack.def labelAttr="abbreviation"}}
      </select>
    </div>
  </div>

  <div class="form-group">
    <label>Attack {{ localize "DND4E.Formula" }}</label>
    <input type="text" name="system.attack.formula" value="{{system.attack.formula}}" placeholder="Do not include 1d20, that will be added automatically"/>
  </div>

  <div class="form-group stacked">
    <label>{{ localize "DND4E.HitDetailsText" }}</label>
    <input type="text" name="system.hit.detail" value="{{system.hit.detail}}" placeholder="{{ localize 'DND4E.PowerTextFieldsPlaceholder'}}"/>
  </div>
  <div class="form-group stacked">
    <label>{{ localize "DND4E.MissDetailsText" }}</label>
    <input type="text" name="system.miss.detail" value="{{system.miss.detail}}" placeholder="{{ localize 'DND4E.PowerTextFieldsPlaceholder'}}"/>
  </div>

  {{/if}}

  <div class="form-group">
    <label>{{ localize "DND4E.IsDamage" }}</label>
    <span class="checkbox"><input type="checkbox" name="system.hit.isDamage" data-dtype="Boolean" {{checked system.hit.isDamage}}/></span>
  </div>
  {{#if system.hit.isDamage}}
  {{!-- Hit Details --}}
  {{!-- Damage --}}
  <div class="form-group">
    <label>{{ localize 'DND4E.FormulaDamage' }}</label>
    <input type="text" name="system.hit.formula" value="{{system.hit.formula}}" placeholder="{{ localize 'DND4E.FormulaDamageExample' }}"/>
  </div>

  <h4 class="damage-header">
    {{ localize 'DND4E.Secondary' }} {{ localize 'DND4E.FormulaDamage' }}:
    <a class="damage-control" data-action="addDamage"><i class="fas fa-plus"></i></a>
  </h4>
  <ol class="damage-parts form-group">
    {{#each system.damage.parts as |part i| }}
    <li class="damage-part flexrow" data-damage-part="{{i}}">
      <input type="text" name="system.damage.parts.{{i}}.0" value="{{lookup this '0'}}"/>
      <select name="system.damage.parts.{{i}}.1">
        {{#select (lookup this "1") }}
        <option value="">&nbsp;</option>
        {{#each ../config.damageTypes as |name type|}}
          {{#unless (eq type "ongoing")}}{{#unless (eq type "damage")}}
          <option value="{{type}}">{{name}}</option>
          {{/unless}}{{/unless}}
        {{/each}}
        {{/select}}
      </select>
      <a class="damage-control" data-action="deleteDamage"><i class="fas fa-minus"></i></a>
    </li>
    {{/each}}
  </ol>
    

  {{!-- Critical --}}
  <div class="form-group ">
    <label>{{ localize 'DND4E.Critical' }} {{ localize 'DND4E.FormulaDamage' }}</label>
    <input type="text" name="system.hit.critFormula" value="{{system.hit.critFormula}}" placeholder="{{ localize 'DND4E.FormulaDamageCritExample' }}"/>
  </div>

  <div class="form-group stacked weapon-properties">
    <label data-tooltip="{{ localize 'DND4E.Damage' }} {{ localize 'DND4E.Type' }}">{{ localize 'DND4E.Damage' }} {{ localize 'DND4E.Type' }}:</label>
    <pr></pr>
    {{#each config.damageTypes as |name type|}}
    <label class="checkbox">
      <input type="checkbox" name="system.damageType.{{type}}" {{checked (lookup ../system.damageType type)}}/> {{ name }}
    </label>
    {{/each}}
  </div>
  {{/if}}
  <div class="form-group">
    <label>{{ localize "DND4E.IsHealing" }}</label>
    <span class="checkbox"><input type="checkbox" name="system.hit.isHealing" data-dtype="Boolean" {{checked system.hit.isHealing}}/></span>
  </div>
  {{#if system.hit.isHealing}}
  <div class="form-group stacked">
    <label>{{ localize 'DND4E.Healing' }} {{ localize "DND4E.Formula" }}</label>
    <input type="text" name="system.hit.healFormula" value="{{system.hit.healFormula}}"/>
  </div>

  <div class="form-group select">
    <label>{{ localize "DND4E.HealingSurgeSpending" }}</label>
    <select name="system.hit.healSurge">
      <option value="">{{ localize "DND4E.None" }}</option>
      <option value="surge">{{ localize "DND4E.HealingSurgeSpend" }}</option>
      <option value="surgeCost">{{ localize "DND4E.HealingSurgeCost" }}</option>
      <option value="surgeValue">{{ localize "DND4E.HealingSurgeValue" }}</option>
      {{selectOptions selected=system.hit.healSurge}}
    </select>
  </div>

  {{/if}}

  {{!-- Other Formula --}}
  <div class="form-group">
    <label>{{ localize "DND4E.OtherFormula" }}</label>
    <input type="text" name="system.formula" value="{{system.formula}}" placeholder="{{ localize 'DND4E.Formula' }}"/>
  </div>

  <div class="form-group">
    <label>{{ localize "DND4E.EffectDetails" }}</label>
    <span class="display-effect">{{ localize "DND4E.DisplayEffect" }}</span>
    <input type="checkbox" name="system.postEffect" data-dtype="Boolean" {{checked system.postEffect}}/>
  </div>
  <div class="form-group">
    <span class="effect-html">{{ localize "DND4E.EffectHTMLInput" }}</span>
    <input type="checkbox" name="system.effectHTML" data-dtype="Boolean" {{checked system.effectHTML}}/>
  </div>
  {{#if system.effectHTML}}
  {{editor effectDetailHTML target="system.effect.detail" button=true owner=owner editable=editable}}
  {{else}}
  <div class="form-group">
    <input type="text" name="system.effect.detail" value="{{system.effect.detail}}" placeholder="{{ localize 
    'DND4E.PowerTextFieldsPlaceholder'}}"/>
  </div>
  {{/if}}
  
  <div class="form-group stacked weapon-properties">
    <label>{{localize 'DND4E.ThingType' thing=(localize 'DND4E.Effect')}}</label>
    <!--<pr></pr>-->
    {{#each config.effectTypes as |name type|}}
    <label class="checkbox">
      <input type="checkbox" name="system.effectType.{{type}}" {{checked (lookup ../system.effectType type)}}/> {{ name }}
    </label>
    {{/each}}
  </div>
  
  {{#unless system.hit.isDamage}} <!--Don't repeat this section if damage has alreday been added -->
    <div class="form-group stacked weapon-properties">
      <label class="damage-type">{{localize 'DND4E.ThingType' thing=(localize 'DND4E.Damage')}}</label>
      {{#if system.damageTypeWeapon}}
        {{#each config.damageTypes as |name type|}}
          {{#unless (eq type "ongoing")}}
          {{#unless (eq type "damage")}}
          <label class="checkbox">
            <input disabled="disabled" type="checkbox" name="system.weaponDamageType.{{type}}" {{checked (lookup ../system.weaponDamageType type)}}/> {{ name }}
          </label>
          {{/unless}}
          {{/unless}}
        {{/each}}
      {{else}}
        {{#each config.damageTypes as |name type|}}
          {{#unless (eq type "ongoing")}}
          {{#unless (eq type "damage")}}
          <label class="checkbox">
            <input type="checkbox" name="system.damageType.{{type}}" {{checked (lookup ../system.damageType type)}}/> {{ name }}
          </label>
          {{/unless}}
          {{/unless}}
        {{/each}}
      {{/if}}
    </div>
  {{/unless}}
    
  {{!--<div class="form-group">
    <label>{{localize 'DND4EUI.AutoFromConfig'}}</label>
    <ul class="auto-keywords inline-list" data-tooltip="{{localize 'DND4EUI.AutoFromConfigTip'}}">
    {{#if labels.damageTypes}}
      <li>{{labels.damageTypes}}</li>
    {{/if}}
    
    {{#each system.autoKeys as |kw|}}
      <li>{{localize kw.label}}</li>
    {{/each}}
    
    </ul>
  </div>--}}
  
  <div class="form-group long">
    <label>{{ localize "DND4E.Custom" }}</label>
    <input type="text" name="system.keywordsCustom" value="{{system.keywordsCustom}}" placeholder="{{ localize 'DND4EUI.StringEnterValues'}}" data-tooltip="{{ localize 'DND4EUI.StringEnterValues'}}" />
  </div>
</div>
